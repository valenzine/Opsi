<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<title>Opsi</title>
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" type="text/css" media="screen" />
		<link rel="stylesheet" href="css/style.css" type="text/css" media="screen" />
		<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
		<script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
		<script type="text/javascript" src="src/jquery.opsi.js"></script>
	</head>
	<body>

		<div class="machineContainer" id="face">
			<div>
				<div id="ojos" class="slotMachine">
					<div class="slot ojos slot1"></div>
					<div class="slot ojos slot2"></div>
					<div class="slot ojos slot3"></div>
					<div class="slot ojos slot4"></div>
					<div class="slot ojos slot5"></div>
					<div class="slot ojos slot6"></div>
					<div class="slot ojos slot7"></div>
					<div class="slot ojos slot8"></div>
					<div class="slot ojos slot9"></div>
					<div class="slot ojos slot10"></div>
					<div class="slot ojos slot11"></div>
					<div class="slot ojos slot12"></div>
					<div class="slot ojos slot13"></div>
					<div class="slot ojos slot14"></div>
					<div class="slot ojos slot15"></div>
					<div class="slot ojos slot16"></div>
					<div class="slot ojos slot17"></div>
					<div class="slot ojos slot18"></div>
					<div class="slot ojos slot19"></div>
					<div class="slot ojos slot20"></div>
					<div class="slot ojos slot21"></div>
					<div class="slot ojos slot22"></div>
					<div class="slot ojos slot23"></div>
					<div class="slot ojos slot24"></div>
					<div class="slot ojos slot25"></div>
					<div class="slot ojos slot26"></div>
					<div class="slot ojos slot27"></div>
					<div class="slot ojos slot28"></div>
					<div class="slot ojos slot29"></div>
					<div class="slot ojos slot30"></div>
					<div class="slot ojos slot31"></div>
					<div class="slot ojos slot32"></div>
					<div class="slot ojos slot33"></div>
					<div class="slot ojos slot34"></div>
					<div class="slot ojos slot35"></div>
					<div class="slot ojos slot36"></div>
					<div class="slot ojos slot37"></div>
					<div class="slot ojos slot38"></div>
					<div class="slot ojos slot39"></div>
					<div class="slot ojos slot40"></div>
					<div class="slot ojos slot41"></div>
					<div class="slot ojos slot42"></div>
					<div class="slot ojos slot43"></div>
					<div class="slot ojos slot44"></div>
					<div class="slot ojos slot45"></div>
					<div class="slot ojos slot46"></div>
					<div class="slot ojos slot47"></div>
					<div class="slot ojos slot48"></div>
					<div class="slot ojos slot49"></div>
					<div class="slot ojos slot50"></div>
					<div class="slot ojos slot51"></div>
					<div class="slot ojos slot52"></div>
					<div class="slot ojos slot53"></div>
					<div class="slot ojos slot54"></div>
					<div class="slot ojos slot55"></div>
				</div>

				<div id="narices" class="slotMachine">
					<div class="slot narices slot1"></div>
					<div class="slot narices slot2"></div>
					<div class="slot narices slot3"></div>
					<div class="slot narices slot4"></div>
					<div class="slot narices slot5"></div>
					<div class="slot narices slot6"></div>
					<div class="slot narices slot7"></div>
					<div class="slot narices slot8"></div>
					<div class="slot narices slot9"></div>
					<div class="slot narices slot10"></div>
					<div class="slot narices slot11"></div>
				</div>

				<div id="bocas" class="slotMachine">
					<div class="slot bocas slot1 "></div>
					<div class="slot bocas slot2 "></div>
					<div class="slot bocas slot3 "></div>
					<div class="slot bocas slot4 "></div>
					<div class="slot bocas slot5 "></div>
					<div class="slot bocas slot6 "></div>
					<div class="slot bocas slot7 "></div>
					<div class="slot bocas slot8 "></div>
					<div class="slot bocas slot9 "></div>
					<div class="slot bocas slot10"></div>
					<div class="slot bocas slot11"></div>
					<div class="slot bocas slot12"></div>
					<div class="slot bocas slot13"></div>
					<div class="slot bocas slot14"></div>
					<div class="slot bocas slot15"></div>
					<div class="slot bocas slot16"></div>
					<div class="slot bocas slot17"></div>
					<div class="slot bocas slot18"></div>
					<div class="slot bocas slot19"></div>
					<div class="slot bocas slot20"></div>
					<div class="slot bocas slot21"></div>
					<div class="slot bocas slot22"></div>
					<div class="slot bocas slot23"></div>
					<div class="slot bocas slot24"></div>
					<div class="slot bocas slot25"></div>
					<div class="slot bocas slot26"></div>
					<div class="slot bocas slot27"></div>
					<div class="slot bocas slot28"></div>
					<div class="slot bocas slot29"></div>
					<div class="slot bocas slot30"></div>
					<div class="slot bocas slot31"></div>
					<div class="slot bocas slot32"></div>
					<div class="slot bocas slot33"></div>
					<div class="slot bocas slot34"></div>
					<div class="slot bocas slot35"></div>
					<div class="slot bocas slot36"></div>
				</div>
			</div>
		</div>			
		<div id="screenshot"></div>

		<script>
			$(document).ready(function(){

			var images = [
				"img/ojos_743d60.png","img/ojos_426a73.png","img/ojos_7c734f.png","img/ojos_2d3b72.png","img/ojos_378061.png","img/ojos_512e88.png","img/ojos_c826b0.png","img/ojos_dee9bd.png","img/ojos_f6ca44.png","img/bocas_743d60.png","img/bocas_426a73.png","img/bocas_7c734f.png","img/bocas_2d3b72.png","img/bocas_378061.png","img/bocas_512e88.png","img/bocas_c826b0.png","img/bocas_dee9bd.png","img/bocas_f6ca44.png","img/narices_743d60.png","img/narices_426a73.png","img/narices_7c734f.png","img/narices_2d3b72.png","img/narices_378061.png","img/narices_512e88.png","img/narices_c826b0.png","img/narices_dee9bd.png","img/narices_f6ca44.png"
			];
			
			$.preload(images);
				
			/*	$.fn.preload = function() {
					this.each(function(){
						$('<img/>')[0].src = this;
					});
				}
				$(["img/ojos_743d60.png","img/ojos_426a73.png","img/ojos_7c734f.png","img/ojos_2d3b72.png","img/ojos_378061.png","img/ojos_512e88.png","img/ojos_c826b0.png","img/ojos_dee9bd.png","img/ojos_f6ca44.png","img/bocas_743d60.png","img/bocas_426a73.png","img/bocas_7c734f.png","img/bocas_2d3b72.png","img/bocas_378061.png","img/bocas_512e88.png","img/bocas_c826b0.png","img/bocas_dee9bd.png","img/bocas_f6ca44.png","img/narices_743d60.png","img/narices_426a73.png","img/narices_7c734f.png","img/narices_2d3b72.png","img/narices_378061.png","img/narices_512e88.png","img/narices_c826b0.png","img/narices_dee9bd.png","img/narices_f6ca44.png"]).preload(); */
				
				//create a new instance of shake.js.
				var myShakeEvent = new Shake({
					threshold: 15
				});

				// start listening to device motion
				myShakeEvent.start();

				// register a shake event
				window.addEventListener('shake', shakeEventDidOccur, false);

				//shake event callback
				function shakeEventDidOccur () {

					//put your own code here etc.
					opsi();
				}


				function toggleFullScreen() {
					var doc = window.document;
					var docEl = doc.documentElement;

					var requestFullScreen = docEl.requestFullscreen || docEl.mozRequestFullScreen || docEl.webkitRequestFullScreen || docEl.msRequestFullscreen;
					var cancelFullScreen = doc.exitFullscreen || doc.mozCancelFullScreen || doc.webkitExitFullscreen || doc.msExitFullscreen;

					//if(!doc.fullscreenElement && !doc.mozFullScreenElement && !doc.webkitFullscreenElement && !doc.msFullscreenElement) {
						requestFullScreen.call(docEl);
					//}
					//else {
					//	cancelFullScreen.call(doc);
					//}
				}
				
				var machine1 = $("#ojos").slotMachine({
					active	: 0,
					delay	: 0
				});
				
				var machine2 = $("#narices").slotMachine({
					active	: 1,
					delay	: 0
				});
				
				var machine3 = $("#bocas").slotMachine({
					active	: 2,
					delay	: 0
				});
				
				var colors = ["743d60","426a73","7c734f","2d3b72","378061","512e88","c826b0","dee9bd","f6ca44"],
					color = colors[Math.floor(colors.length * Math.random())];
					
				function switchColors(){
					color = colors[Math.floor(colors.length * Math.random())];
				}
				
				function onComplete(active){
				
					switch(this.element[0].id){
						case 'ojos':
							var activo1 = this.active + 1;
							$(".ojos.slot"+activo1).removeClass().addClass('ojos slot'+activo1+' c'+color);
							break;
						case 'narices':
							var activo2 = this.active + 1;
							$(".narices.slot"+activo2).removeClass().addClass('narices slot'+activo2+' c'+color);
							break;
						case 'bocas':
							var activo3 = this.active + 1;
							$(".bocas.slot"+activo3).removeClass().addClass('bocas slot'+activo3+' c'+color);
						//	$("#face, body").animate({backgroundColor:color[0]},1500);
							break;
					}
				}
				
				$("#face").click(function(){
					opsi();
				});	
				
				$("#screenshot").click(function(){
					navigator.screenshot.save(function(error,res){
						if(error){
							console.error(error);
						}else{
							console.log('ok',res.filePath);
						}
					});
					alert('Screenshot!');
				});
				

				
				
				function opsi() {
				
					switchColors();
					if (navigator.userAgent.match(/(iPod|iPhone|iPad)/)) {} else {
						toggleFullScreen();
					}
					machine1.shuffle(1, onComplete);
					machine2.shuffle(1, onComplete);
					machine3.shuffle(1, onComplete);
				};
				
			});
		</script>	

	</body>
</html>
